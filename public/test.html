<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <input type="file" onchange="saveFile()"><br>
    <script type="text/javascript">
      function saveFile() {
      //   var preview = document.querySelector('img');
        var file    = document.querySelector('input[type=file]').files[0];
        var reader  = new FileReader();

        reader.addEventListener("load", function () {
          const request = new XMLHttpRequest();
          const payload = JSON.stringify({
            locationFirst: 'site 1',
            locationSecond: 'floor 1',
            locationThird: 'room 1',
            photo: reader.result,
            description: 'hey there',
            reportType: 'near miss'
          })
          request.open('POST', '/report')
          request.setRequestHeader('Content-Type', 'application/json');
          request.send(payload)
      //     console.log(reader)
      //     console.log(file)
      //     preview.src = reader.result;
        }, false);

        if (file) {
          reader.readAsDataURL(file);
        }
      }
    </script>
  </body>
</html>
